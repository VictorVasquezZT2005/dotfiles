;; ======================================================
;; POLYBAR i3 – DRACULA STYLE
;; ======================================================

[color]
bg = #282a36
bg-alt = #44475a
fg = #f8f8f2
mb = #343746

cyan = #8be9fd
green = #50fa7b
orange = #ffb86c
pink = #ff79c6
purple = #bd93f9
red = #ff5555
yellow = #f1fa8c
blue = #6272a4
comment = #6272a4

;; ======================================================
;; BARRA
;; ======================================================

[bar/main]
width = 100%
height = 28
offset-x = 0
offset-y = 0
bottom = false
fixed-center = true

background = ${color.bg}
foreground = ${color.fg}

radius = 0
line-size = 2
line-color = ${color.purple}

padding = 0
module-margin-left = 0
module-margin-right = 0

font-0 = "JetBrainsMono Nerd Font:style=Bold:size=9;3"
font-1 = "Font Awesome 6 Free Solid:size=10;3"
font-2 = "Material Design Icons Desktop:size=12;3"
font-3 = "MesloLGS NF:style=Regular:size=16;4"

modules-left   = bi i3 bd sep bi cpu_bar bd sep bi memory_bar bd sep bi brightness bd
modules-center = bi date bd
modules-right  = bi pulseaudio bd sep bi network bd sep bi bluetooth bd sep bi battery bd sep tray power

wm-restack = i3
enable-ipc = true

;; ======================================================
;; DECORADORES
;; ======================================================

[module/bi]
type = custom/text
label = "%{T4}%{T-}"
label-foreground = ${color.mb}
label-background = ${color.bg}

[module/bd]
type = custom/text
label = "%{T4}%{T-}"
label-foreground = ${color.mb}
label-background = ${color.bg}

[module/sep]
type = custom/text
label = " "
label-background = ${color.bg}

;; ======================================================
;; i3 WORKSPACES
;; ======================================================

[module/i3]
type = internal/i3
format = <label-state>
format-background = ${color.mb}
index-sort = true

label-focused   = " %index% 󰮯 "
label-focused-foreground = ${color.green}

label-unfocused = " %index% 󰊠 "
label-unfocused-foreground = ${color.comment}

label-visible   = " %index% 󰑊 "
label-visible-foreground = ${color.purple}

label-urgent    = " %index% 󰀦 "
label-urgent-foreground = ${color.red}

;; ======================================================
;; SISTEMA
;; ======================================================

[module/cpu_bar]
type = internal/cpu
interval = 1
format = <label>
format-prefix = " 󰻠 "
format-prefix-foreground = ${color.cyan}
format-background = ${color.mb}
label = "%percentage%% "

[module/memory_bar]
type = internal/memory
interval = 3
format = <label>
format-prefix = " 󰍛 "
format-prefix-foreground = ${color.purple}
format-background = ${color.mb}
label = "%percentage_used%% "

[module/brightness]
type = internal/backlight
card = intel_backlight
enable-scroll = true

format = <label>
format-prefix = " 󰃠 "
format-prefix-foreground = ${color.yellow}
format-background = ${color.mb}
label = "%percentage%% "

;; ======================================================
;; FECHA / HORA
;; ======================================================

[module/date]
type = internal/date
interval = 1
time = %I:%M %p
format = <label>
format-prefix = " 󰥔 "
format-prefix-foreground = ${color.pink}
format-background = ${color.mb}
label = "%time% "

;; ======================================================
;; AUDIO
;; ======================================================

[module/pulseaudio]
type = internal/pulseaudio
use-ui-max = true
enable-scroll = true

format-volume = <label-volume>
format-volume-prefix = " 󰕾 "
format-volume-prefix-foreground = ${color.purple}
format-volume-background = ${color.mb}
label-volume = "%percentage%% "

format-muted = <label-muted>
format-muted-prefix = " 󰖁 "
format-muted-background = ${color.mb}
label-muted = "Muted "
label-muted-foreground = ${color.red}

;; ======================================================
;; BLUETOOTH
;; ======================================================

[module/bluetooth]
type = custom/text
label = "  "
label-foreground = ${color.blue}
label-background = ${color.mb}
click-left = ~/.config/polybar/bluetooth-menu.sh

;; ======================================================
;; RED
;; ======================================================

[module/network]
type = internal/network
interface = wlp2s0
interval = 3

# Usamos format-connected para envolver TODO el bloque en la acción de clic
format-connected = %{A1:~/.config/polybar/wifi-menu.sh:}<label-connected>%{A}
format-connected-prefix = " 󰖩 "
format-connected-prefix-foreground = ${color.green}
format-connected-background = ${color.mb}
# El label debe incluir el nombre de la red
label-connected = "%essid% "
label-connected-background = ${color.mb}

format-disconnected = %{A1:~/.config/polybar/wifi-menu.sh:}<label-disconnected>%{A}
format-disconnected-prefix = " 󰖪 "
format-disconnected-prefix-foreground = ${color.red}
format-disconnected-background = ${color.mb}
label-disconnected = " Offline "
label-disconnected-foreground = ${color.red}
label-disconnected-background = ${color.mb}

;; ======================================================
;; BATERÍA
;; ======================================================

[module/battery]
type = custom/script
exec = ~/.config/polybar/battery-status.sh
interval = 5
format-background = ${color.mb}
format-foreground = ${color.fg}
format-padding = 1
click-left = ~/.config/polybar/power-profile.sh
label = %output%

;; ======================================================
;; TRAY / POWER
;; ======================================================

[module/tray]
type = internal/tray
tray-size = 65%
tray-spacing = 8px
format-background = ${color.bg}

[module/power]
type = custom/text
label = "  "
label-foreground = ${color.red}
label-background = ${color.bg}
click-left = ~/.config/polybar/powermenu.sh